---
layout: post
title: Tomcat - logging all HTTP traffic with Logback
date: 2014-11-05 09:31:44.000000000 -06:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  _edit_last: '14827209'
  _publicize_pending: '1'
  geo_public: '0'
author:
  login: acrocontext
  email: nsclass@hotmail.com
  display_name: acrocontext
  first_name: ''
  last_name: ''
permalink: "/2014/11/05/tomcat-logging-all-http-traffic-with-logback/"
---
<p>1. Install logback in a tomcat\lib folder<br />
   logback-access-1.1.2.jar<br />
   logback-core-1.1.2.jar</p>
<p>2. Create a logback-access.xml in a tomcat\conf foler<br />
Example)<br />
[code]<br />
&lt;configuration&gt;<br />
  &lt;appender name=&quot;cgFileRoller&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;<br />
    &lt;file&gt;c:/logs/logback.log&lt;/file&gt;<br />
    &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;<br />
      &lt;fileNamePattern&gt;cg-logback.%d{yyyy-MM-dd}.log.zip&lt;/fileNamePattern&gt;<br />
    &lt;/rollingPolicy&gt;</p>
<p>    &lt;encoder&gt;<br />
      &lt;pattern&gt;%fullRequest%n%n%fullResponse&lt;/pattern&gt;<br />
    &lt;/encoder&gt;<br />
  &lt;/appender&gt;</p>
<p>  &lt;appender-ref ref=&quot;cgFileRoller&quot; /&gt;<br />
&lt;/configuration&gt;<br />
[/code]</p>
<p>3. Modify server.xml in a tomcat/conf folder<br />
Example)<br />
[code]<br />
      &lt;Host appBase=&quot;webapps&quot; autoDeploy=&quot;true&quot; name=&quot;localhost&quot; unpackWARs=&quot;true&quot;&gt;</p>
<p>        &lt;!-- SingleSignOn valve, share authentication between web applications<br />
             Documentation at: /docs/config/valve.html --&gt;<br />
        &lt;!--<br />
        &lt;Valve className=&quot;org.apache.catalina.authenticator.SingleSignOn&quot; /&gt;<br />
        --&gt;</p>
<p>        &lt;!-- Access log processes all example.<br />
             Documentation at: /docs/config/valve.html<br />
             Note: The pattern used is equivalent to using pattern=&quot;common&quot; --&gt;<br />
        &lt;Valve className=&quot;org.apache.catalina.valves.AccessLogValve&quot; directory=&quot;logs&quot; pattern=&quot;%h %l %u %t &amp;quot;%r&amp;quot; %s %b&quot; prefix=&quot;localhost_access_log.&quot; suffix=&quot;.txt&quot;/&gt;<br />
        &lt;Valve className=&quot;ch.qos.logback.access.tomcat.LogbackValve&quot;/&gt;</p>
<p>&lt;/Host&gt;<br />
[/code]</p>
<p>4. Modify web.xml to register filer<br />
Example)<br />
[code]<br />
&lt;filter&gt;<br />
  &lt;filter-name&gt;TeeFilter&lt;/filter-name&gt;<br />
  &lt;filter-class&gt;ch.qos.logback.access.servlet.TeeFilter&lt;/filter-class&gt;<br />
&lt;/filter&gt;</p>
<p>&lt;filter-mapping&gt;<br />
  &lt;filter-name&gt;TeeFilter&lt;/filter-name&gt;<br />
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br />
&lt;/filter-mapping&gt;<br />
[/code]</p>

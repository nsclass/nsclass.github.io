---
layout: single
title: Spark - Cassandra connector example
date: 2019-06-15 20:47:10.000000000 -05:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Programming
- Spark
tags: []
meta:
  _edit_last: '14827209'
  _oembed_36d97139f06432ceace018aca9696459: "{{unknown}}"
  geo_public: '0'
  _publicize_job_id: '31868832868'
  timeline_notification: '1560649630'
  _oembed_ce7abf32e3abab13dd8311ee727f51a6: "{{unknown}}"
  _oembed_2cb4019330fb25d9003d12a88de6111b: "{{unknown}}"
  _oembed_0ab9cc469e0a0b6830b4218e32f79bf6: "{{unknown}}"
author:
  login: acrocontext
  email: nsclass@hotmail.com
  display_name: acrocontext
  first_name: ''
  last_name: ''
permalink: "/2019/06/15/spark-cassandra-connector-example/"
---
<p>Github<br />
https://github.com/nsclass/spark-cassandra-example</p>
<p>[code lang="c"]<br />
object SparkCassandra {<br />
  def main(args: Array[String]): Unit = {<br />
    val spark = SparkSession.builder()<br />
      .appName(&quot;SparkCassandra&quot;)<br />
      .master(&quot;local&quot;)<br />
      .config(&quot;spark.cassandra.connection.host&quot;, &quot;127.0.0.1&quot;)<br />
      .getOrCreate()</p>
<p>    // Read data as RDD<br />
    val rdd = spark.sparkContext.cassandraTable(keyspace = &quot;system&quot;, table = &quot;local&quot;)<br />
      .select(&quot;key&quot;, &quot;cluster_name&quot;, &quot;cql_version&quot;)</p>
<p>    println(&quot;Data read as RDD&quot;)<br />
    rdd.collect()<br />
      .foreach(row =&gt; {<br />
        println(row.getString(&quot;key&quot;))<br />
        println(row.getString(&quot;cluster_name&quot;))<br />
        println(row.getString(&quot;cql_version&quot;))<br />
      })</p>
<p>    // Read data as DataSet (DataFrame)<br />
    val dataset = spark.read<br />
      .cassandraFormat(keyspace = &quot;system&quot;, table = &quot;local&quot;)<br />
      .load()</p>
<p>    dataset.collect()<br />
      .foreach(row =&gt; {<br />
        println(row.getAs(&quot;key&quot;))<br />
        println(row.getAs(&quot;cluster_name&quot;))<br />
        println(row.getAs(&quot;cql_version&quot;))<br />
      })<br />
  }<br />
}<br />
[/code]</p>
